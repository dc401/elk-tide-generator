{
  "timestamp": "2026-02-08T14:05:12.186966",
  "total_rules": 7,
  "successful_conversions": 7,
  "approved_queries": 1,
  "rejected_queries": 6,
  "validations": [
    {
      "valid": false,
      "overall_score": 0.0,
      "decision": "REJECT",
      "issues": [
        "Failed to parse LLM validation response"
      ],
      "error": "Unterminated string starting at: line 18 column 5 (char 1598)",
      "rule_id": "c1a7b8d9-0f1e-4d2c-8a3b-4e5f6a7b8c9d",
      "rule_title": "Akira Ransomware: Ransom Note Creation"
    },
    {
      "valid": false,
      "overall_score": 0.0,
      "decision": "REJECT",
      "issues": [
        "Failed to parse LLM validation response"
      ],
      "error": "Unterminated string starting at: line 13 column 5 (char 370)",
      "rule_id": "f5a2b1c3-6d9e-4a7b-8b1c-9d8e7f6a5b4c",
      "rule_title": "Akira Ransom Note Creation"
    },
    {
      "valid": false,
      "overall_score": 0.0,
      "decision": "REJECT",
      "issues": [
        "Failed to parse LLM validation response"
      ],
      "error": "Unterminated string starting at: line 19 column 5 (char 1436)",
      "rule_id": "e8d9c0a1-7b6c-4f5d-8a4b-3c2d1e0f9a8b",
      "rule_title": "Akira File Encryption Extension Detected"
    },
    {
      "valid": false,
      "overall_score": 0.0,
      "decision": "REJECT",
      "issues": [
        "Failed to parse LLM validation response"
      ],
      "error": "Unterminated string starting at: line 17 column 5 (char 1670)",
      "rule_id": "f8a0b3c1-1e9d-4c5b-9a8f-2e3d7a6b4c10",
      "rule_title": "Akira Ransomware Note Creation"
    },
    {
      "valid": true,
      "syntax_score": 1.0,
      "field_mapping_score": 1.0,
      "logic_accuracy_score": 1.0,
      "performance_score": 0.3,
      "overall_score": 0.72,
      "issues": [
        "The query relies on the `query_string` type, which is less performant and precise than a native `bool` query.",
        "The query uses leading wildcards (e.g., `*delete shadows*`) on multiple fields. This is a significant performance anti-pattern as it prevents the search engine from using the inverted index efficiently and results in slow, resource-intensive queries. [4, 13]"
      ],
      "warnings": [
        "The case sensitivity of the `query_string` depends on the underlying index mapping for the fields. If fields like `process.command_line` are not analyzed as `text`, the wildcard matches may be case-sensitive and could miss variations."
      ],
      "recommendations": [
        "The query should be rewritten using the Elasticsearch `bool` query structure. This provides better performance, readability, and control.",
        "Replace the wildcard-based `contains` logic with `match_phrase` queries for the `process.command_line` field. For the parent process executables, use `term` or `match` queries on a `.keyword` field if an exact match is sufficient, or `wildcard` queries as a last resort.",
        "The overall structure should be a `bool` query with a `must` clause for the 'selection' criteria and a `must_not` clause for the 'filter_legitimate' criteria."
      ],
      "decision": "REJECT",
      "rule_id": "e2f7b1d4-8c8a-4d7a-8f6a-0d9c44b1b3e1",
      "rule_title": "Akira Ransomware Inhibit System Recovery via Command"
    },
    {
      "valid": false,
      "overall_score": 0.0,
      "decision": "REJECT",
      "issues": [
        "Failed to parse LLM validation response"
      ],
      "error": "Unterminated string starting at: line 21 column 5 (char 1757)",
      "rule_id": "d4e6f1a8-3b9c-4d5e-9f0a-1b2c3d4e5f6a",
      "rule_title": "Akira Ransomware: File Encryption Activity"
    },
    {
      "valid": true,
      "syntax_score": 1.0,
      "field_mapping_score": 1.0,
      "logic_accuracy_score": 0.5,
      "performance_score": 0.7,
      "overall_score": 0.84,
      "issues": [
        "The 'query_string' query uses a text analyzer by default, which is not ideal for matching an exact filename. [8] The standard analyzer may tokenize the value 'akira_readme.txt' into 'akira_readme' and 'txt', which would fail to match the literal string. This can lead to missed detections if the analysis process breaks the filename in an unexpected way. [4]"
      ],
      "warnings": [
        "For exact, case-sensitive matching, a `term` query on a `keyword` field is significantly more performant and reliable than a `query_string` query. [2, 6] The `query_string` query incurs overhead from parsing and analysis that is unnecessary for this type of exact match. [10]"
      ],
      "recommendations": [
        "To ensure an exact match and improve performance, the query should be rewritten to use the `term` query on the `.keyword` subfield of `file.name`. The recommended Elasticsearch DSL query is: `{\"query\": {\"term\": {\"file.name.keyword\": \"akira_readme.txt\"}}}`. This change guarantees that the query looks for the precise filename without any tokenization."
      ],
      "decision": "APPROVE",
      "rule_id": "f0e1d2c3-b4a5-46c7-88d9-e0f1a2b3c4d5",
      "rule_title": "Akira Ransomware Note Creation"
    }
  ]
}
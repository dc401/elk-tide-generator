title: Akira Ransomware Stops Critical Services via Command
id: a9b0c2d1-5e4f-4a0b-9c8d-3f1a2e7c6b5e
status: stable
description: Detects command-line attempts to stop or disable critical services related
  to backups, databases, and security software. This is a common tactic used by Akira
  ransomware to prepare a system for encryption.
references:
- https://attack.mitre.org/techniques/T1489/
- https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-353a
author: Automated Detection Agent
date: '2024-07-29'
modified: '2024-07-30'
tags:
- attack.impact
- attack.t1489
logsource:
  product: windows
  service: process_creation
  category: process_creation
detection:
  selection:
    process.name:
    - net.exe
    - sc.exe
    process.command_line|contains|any:
    - Veeam
    - SQL
    - Sophos
    - Acronis
    - BackupExec
    - Oracle
    - Defender
    - msmpeng
    - CrowdStrike
  condition: selection
falsepositives:
- Legitimate administrators stopping these services for maintenance or troubleshooting.
level: medium
fields:
- user.name
- process.executable
- process.command_line
- process.parent.executable
- host.name
test_scenarios:
  true_positive: A script executes `net stop "Veeam Backup Service" /y` to halt backup
    operations.
  false_negative: An attacker uses `taskkill /IM sqlservr.exe /F` to terminate the
    database process directly instead of stopping the service gracefully.
  false_positive: A database administrator runs `net stop "SQL Server (MSSQLSERVER)"`
    to perform a manual backup.
  true_negative: A user runs `net start spooler` to start the print spooler service.
  log_source_schema: https://www.elastic.co/guide/en/ecs/current/ecs-process.html
  example_log_fields:
    process.name: net.exe
    process.command_line: net stop "Veeam Backup Service"
    user.name: compromised_admin
    event.category: process_creation

title: Akira File Encryption Extension Detected
id: e8d9c0a1-7b6c-4f5d-8a4b-3c2d1e0f9a8b
status: stable
description: Detects the creation of files with the '.akira' extension, which is appended
  to files encrypted by the Akira ransomware. This activity indicates that data encryption
  is in progress.
references:
- https://attack.mitre.org/techniques/T1486/
- https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-353a
author: Automated Detection Agent
date: '2024-07-29'
modified: '2024-07-30'
tags:
- attack.impact
- attack.t1486
logsource:
  product: windows
  service: sysmon
  category: file_creation
detection:
  selection:
    event.code: '11'
    file.name|contains: .akira
  filter_legitimate:
    process.executable|contains:
    - explorer.exe
    - unzip.exe
    - 7z.exe
  condition: selection and not filter_legitimate
falsepositives:
- Legitimate files that may coincidentally contain '.akira' in their name.
- Unpacking of forensic samples or threat intelligence reports containing filenames
  with this extension using tools like 7zip or unzip.
level: high
fields:
- host.name
- process.executable
- file.name
- file.path
- user.name
test_scenarios:
  true_positive: A ransomware process creates a file 'C:\Data\mydocument.docx.akira'
    after encrypting the original.
  false_negative: The ransomware encrypts the file in-place without creating a new
    file, thus evading file creation events (Sysmon Event 11).
  false_positive: A security analyst unzips a threat intel report containing a sample
    file named 'report.akira.doc'.
  true_negative: A file named 'mydocument.docx' is created by Microsoft Word.
  log_source_schema: https://www.elastic.co/guide/en/ecs/current/ecs-file.html
  example_log_fields:
    event.code: '11'
    file.name: report.pdf.akira
    file.path: C:\Users\victim\Documents\report.pdf.akira
    process.executable: C:\Windows\Temp\akira_x64.exe

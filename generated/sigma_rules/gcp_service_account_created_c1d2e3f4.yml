title: GCP Service Account Created
id: c1d2e3f4-a5b6-4f7a-8b9c-0d1e2f3a4b5c
status: experimental
description: Detects the creation of a new service account (T1136.003). Attackers
  create new service accounts to use as a persistent backdoor, as they are non-human
  identities that are often less scrutinized than user accounts.
references:
- https://attack.mitre.org/techniques/T1136/003/
- https://cloud.google.com/iam/docs/creating-managing-service-accounts
author: Automated Detection Agent
date: '2024-07-31'
modified: '2024-07-31'
tags:
- attack.persistence
- attack.t1136.003
logsource:
  product: gcp
  service: gcp.audit
detection:
  selection:
    protoPayload.serviceName: iam.googleapis.com
    protoPayload.methodName: google.iam.admin.v1.CreateServiceAccount
    protoPayload.status.code: 0
  filter_legitimate:
    protoPayload.authenticationInfo.principalEmail|endswith:
    - -compute@developer.gserviceaccount.com
    - terraform-prod@my-project.iam.gserviceaccount.com
  condition: selection and not filter_legitimate
falsepositives:
- Legitimate creation of service accounts for new applications or resources by administrators.
- Automated infrastructure-as-code (IaC) tools like Terraform provisioning new service
  accounts as part of a deployment.
level: low
fields:
- protoPayload.authenticationInfo.principalEmail
- protoPayload.request.accountId
- protoPayload.response.email
- resource.labels.project_id
- timestamp
test_scenarios:
  true_positive: An attacker, having compromised a developer account, creates a new
    service account named 'gcp-billing-sync' to blend in and use as a backdoor.
  false_negative: An attacker compromises and re-uses an existing, dormant service
    account instead of creating a new one.
  false_positive: Terraform runs and creates a new service account for a new application
    as defined in its configuration files.
  true_negative: An administrator lists the existing service accounts in a project.
  log_source_schema: https://cloud.google.com/logging/docs/audit#audit_log_entry_structure
  example_log_fields:
    protoPayload.methodName: google.iam.admin.v1.CreateServiceAccount
    protoPayload.request.accountId: backdoor-sa
    protoPayload.authenticationInfo.principalEmail: compromised-user@example.com

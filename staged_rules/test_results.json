{
  "timestamp": "2026-02-09 23:08:54",
  "rules_tested": 3,
  "overall_metrics": {
    "TP": 7,
    "FN": 0,
    "FP": 9,
    "TN": 0,
    "total": 16,
    "precision": 0.438,
    "recall": 1.0,
    "f1_score": 0.609,
    "accuracy": 0.438
  },
  "rule_results": [
    {
      "rule_name": "scattered_spider_-_gcp_firewall_rule_modification",
      "query": "event.category:api AND cloud.provider:gcp AND event.outcome:success AND event.action:(compute.firewalls.insert OR compute.firewalls.update OR compute.firewalls.patch OR compute.firewalls.delete)",
      "results": {
        "TP": 2,
        "FN": 0,
        "FP": 3,
        "TN": 0
      },
      "metrics": {
        "TP": 2,
        "FN": 0,
        "FP": 3,
        "TN": 0,
        "total": 5,
        "precision": 0.4,
        "recall": 1.0,
        "f1_score": 0.571,
        "accuracy": 0.4
      },
      "details": [
        {
          "test_num": 1,
          "test_type": "TP",
          "description": "Successful creation of a new GCP firewall rule",
          "expected_match": true,
          "actual_match": true,
          "outcome": "TP"
        },
        {
          "test_num": 2,
          "test_type": "TP",
          "description": "Successful deletion of a GCP firewall rule",
          "expected_match": true,
          "actual_match": true,
          "outcome": "TP"
        },
        {
          "test_num": 3,
          "test_type": "FN",
          "description": "Evasion by modifying network routes directly on a VM",
          "expected_match": false,
          "actual_match": true,
          "outcome": "FP"
        },
        {
          "test_num": 4,
          "test_type": "FP",
          "description": "Failed attempt to update a GCP firewall rule",
          "expected_match": false,
          "actual_match": true,
          "outcome": "FP"
        },
        {
          "test_num": 5,
          "test_type": "TN",
          "description": "Benign GCP API call (listing firewall rules)",
          "expected_match": false,
          "actual_match": true,
          "outcome": "FP"
        }
      ]
    },
    {
      "rule_name": "akira_ransomware_-_windows_shadow_copy_deletion",
      "query": "event.category:process AND event.type:start AND event.code:1 AND (process.name:(*vssadmin* OR *wmic* OR *bcdedit*) AND process.command_line:(*delete*shadows* OR *shadowcopy*delete* OR *recoveryenabled*no* OR *bootstatuspolicy*ignoreallfailures*))",
      "results": {
        "TP": 3,
        "FN": 0,
        "FP": 3,
        "TN": 0
      },
      "metrics": {
        "TP": 3,
        "FN": 0,
        "FP": 3,
        "TN": 0,
        "total": 6,
        "precision": 0.5,
        "recall": 1.0,
        "f1_score": 0.667,
        "accuracy": 0.5
      },
      "details": [
        {
          "test_num": 1,
          "test_type": "TP",
          "description": "Malicious vssadmin shadow deletion",
          "expected_match": true,
          "actual_match": true,
          "outcome": "TP"
        },
        {
          "test_num": 2,
          "test_type": "TP",
          "description": "Malicious wmic shadow copy deletion",
          "expected_match": true,
          "actual_match": true,
          "outcome": "TP"
        },
        {
          "test_num": 3,
          "test_type": "TP",
          "description": "Malicious bcdedit to disable recovery",
          "expected_match": true,
          "actual_match": true,
          "outcome": "TP"
        },
        {
          "test_num": 4,
          "test_type": "FN",
          "description": "PowerShell evasion using WMI API for shadow deletion",
          "expected_match": false,
          "actual_match": true,
          "outcome": "FP"
        },
        {
          "test_num": 5,
          "test_type": "FP",
          "description": "Admin checking shadow copy status",
          "expected_match": false,
          "actual_match": true,
          "outcome": "FP"
        },
        {
          "test_num": 6,
          "test_type": "TN",
          "description": "Normal system activity",
          "expected_match": false,
          "actual_match": true,
          "outcome": "FP"
        }
      ]
    },
    {
      "rule_name": "scattered_spider_-_gcp_compute_snapshot_deletion",
      "query": "event.category:api AND cloud.provider:gcp AND event.action:compute.snapshots.delete AND event.outcome:success",
      "results": {
        "TP": 2,
        "FN": 0,
        "FP": 3,
        "TN": 0
      },
      "metrics": {
        "TP": 2,
        "FN": 0,
        "FP": 3,
        "TN": 0,
        "total": 5,
        "precision": 0.4,
        "recall": 1.0,
        "f1_score": 0.571,
        "accuracy": 0.4
      },
      "details": [
        {
          "test_num": 1,
          "test_type": "TP",
          "description": "Successful deletion of a GCP compute snapshot",
          "expected_match": true,
          "actual_match": true,
          "outcome": "TP"
        },
        {
          "test_num": 2,
          "test_type": "TP",
          "description": "Another successful deletion of a GCP compute snapshot",
          "expected_match": true,
          "actual_match": true,
          "outcome": "TP"
        },
        {
          "test_num": 3,
          "test_type": "FN",
          "description": "Evasion by deleting the underlying disk instead of the snapshot",
          "expected_match": false,
          "actual_match": true,
          "outcome": "FP"
        },
        {
          "test_num": 4,
          "test_type": "FP",
          "description": "Failed attempt to delete a GCP compute snapshot",
          "expected_match": false,
          "actual_match": true,
          "outcome": "FP"
        },
        {
          "test_num": 5,
          "test_type": "TN",
          "description": "Benign GCP API call (listing instances)",
          "expected_match": false,
          "actual_match": true,
          "outcome": "FP"
        }
      ]
    }
  ]
}
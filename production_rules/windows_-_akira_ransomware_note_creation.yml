name: Windows - Akira Ransomware Note Creation
description: Detects the creation of known Akira ransomware notes (e.g., akira_readme.txt).
  This is a high-fidelity indicator of data encryption for impact, signifying a successful
  ransomware attack.
type: query
query: event.category:file AND event.type:creation AND file.name:(*akira_readme.txt
  OR *akira_readme.html)
language: lucene
index:
- winlogbeat-*
- logs-*
- filebeat-*
filters: []
risk_score: 95
severity: critical
threat:
- framework: MITRE ATT&CK
  tactic:
    id: TA0040
    name: Impact
    reference: https://attack.mitre.org/tactics/TA0040/
  technique:
  - id: T1486
    name: Data Encrypted for Impact
    reference: https://attack.mitre.org/techniques/T1486/
references:
- https://attack.mitre.org/techniques/T1486/
- https://www.elastic.co/guide/en/ecs/current/ecs-file.html
author:
- Detection Agent
false_positives:
- Extremely unlikely, as 'akira_readme.txt' is a highly specific ransomware indicator.
  Manual file creation with this exact name would be suspicious.
note: '## Triage

  Immediate investigation required. This indicates a confirmed ransomware infection.
  Isolate the affected host(s) and initiate incident response procedures. Identify
  the process responsible for file creation and its parentage.'
test_cases:
- type: TP
  description: Creation of akira_readme.txt ransom note
  log_entry:
    event:
      category: file
      type: creation
      code: 11
    file:
      name: akira_readme.txt
      path: C:\Users\Victim\Documents\akira_readme.txt
      extension: txt
    process:
      name: ransomware.exe
    '@timestamp': '2024-03-12T22:30:00Z'
  expected_match: true
  evasion_technique: null
- type: TP
  description: Creation of akira_readme.html ransom note
  log_entry:
    event:
      category: file
      type: creation
      code: 11
    file:
      name: akira_readme.html
      path: C:\Share\akira_readme.html
      extension: html
    process:
      name: malicious_payload.exe
    '@timestamp': '2024-03-12T22:30:15Z'
  expected_match: true
  evasion_technique: null
- type: FN
  description: Ransomware uses a different ransom note name
  log_entry:
    event:
      category: file
      type: creation
      code: 11
    file:
      name: _readme.txt
      path: C:\Users\Victim\_readme.txt
      extension: txt
    process:
      name: ransomware.exe
    '@timestamp': '2024-03-12T22:31:00Z'
  expected_match: false
  evasion_technique: Ransomware uses a different naming convention for its ransom
    note, bypassing detection based on specific filenames.
- type: FP
  description: Legitimate file with similar naming pattern (backup/archive)
  log_entry:
    event:
      category: file
      type: creation
      code: 11
    file:
      name: backup_akira_readme.txt
      path: D:\Backups\2024\backup_akira_readme.txt
      extension: txt
    process:
      name: robocopy.exe
      command_line: robocopy D:\Projects D:\Backups\2024 /E
    user:
      name: SYSTEM
    '@timestamp': '2024-03-14T02:00:00Z'
  expected_match: true
  evasion_technique: null
- type: TN
  description: Normal document creation
  log_entry:
    event:
      category: file
      type: creation
      code: 11
    file:
      name: report.docx
      path: C:\Users\User3\Documents\report.docx
      extension: docx
    process:
      name: winword.exe
    '@timestamp': '2024-03-14T12:05:00Z'
  expected_match: false
  evasion_technique: null

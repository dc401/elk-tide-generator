{
  "timestamp": "2026-02-10 01:28:23",
  "rules_tested": 10,
  "overall_metrics": {
    "TP": 16,
    "FN": 2,
    "FP": 24,
    "TN": 6,
    "total": 48,
    "precision": 0.4,
    "recall": 0.889,
    "f1_score": 0.552,
    "accuracy": 0.458
  },
  "rule_results": [
    {
      "rule_name": "scattered_spider_-_gcp_delete_compute_snapshot",
      "query": "event.category:api AND cloud.provider:gcp AND event.action:compute.snapshots.delete AND event.outcome:success",
      "results": {
        "TP": 1,
        "FN": 0,
        "FP": 3,
        "TN": 0
      },
      "metrics": {
        "TP": 1,
        "FN": 0,
        "FP": 3,
        "TN": 0,
        "total": 4,
        "precision": 0.25,
        "recall": 1.0,
        "f1_score": 0.4,
        "accuracy": 0.25
      },
      "details": [
        {
          "test_num": 1,
          "test_type": "TP",
          "description": "Successful deletion of a GCP compute snapshot",
          "expected_match": true,
          "actual_match": true,
          "outcome": "TP"
        },
        {
          "test_num": 2,
          "test_type": "FN",
          "description": "Failed attempt to delete a GCP compute snapshot",
          "expected_match": false,
          "actual_match": true,
          "outcome": "FP"
        },
        {
          "test_num": 3,
          "test_type": "FP",
          "description": "Legitimate listing of GCP compute snapshots",
          "expected_match": false,
          "actual_match": true,
          "outcome": "FP"
        },
        {
          "test_num": 4,
          "test_type": "TN",
          "description": "Normal GCP compute instance creation",
          "expected_match": false,
          "actual_match": true,
          "outcome": "FP"
        }
      ]
    },
    {
      "rule_name": "scattered_spider_-_gcp_os_password_reset",
      "query": "event.category:api AND cloud.provider:gcp AND event.action:compute.instances.reset AND event.outcome:success",
      "results": {
        "TP": 1,
        "FN": 0,
        "FP": 3,
        "TN": 0
      },
      "metrics": {
        "TP": 1,
        "FN": 0,
        "FP": 3,
        "TN": 0,
        "total": 4,
        "precision": 0.25,
        "recall": 1.0,
        "f1_score": 0.4,
        "accuracy": 0.25
      },
      "details": [
        {
          "test_num": 1,
          "test_type": "TP",
          "description": "Successful OS password reset on a GCP compute instance",
          "expected_match": true,
          "actual_match": true,
          "outcome": "TP"
        },
        {
          "test_num": 2,
          "test_type": "FN",
          "description": "Password reset via 'passwd' command within a Linux instance",
          "expected_match": false,
          "actual_match": true,
          "outcome": "FP"
        },
        {
          "test_num": 3,
          "test_type": "FP",
          "description": "Legitimate stopping of a GCP compute instance",
          "expected_match": false,
          "actual_match": true,
          "outcome": "FP"
        },
        {
          "test_num": 4,
          "test_type": "TN",
          "description": "Normal GCP compute instance start",
          "expected_match": false,
          "actual_match": true,
          "outcome": "FP"
        }
      ]
    },
    {
      "rule_name": "scattered_spider_-_gcp_ssh_backdoor_(metadata_modification)",
      "query": "event.category:api AND cloud.provider:gcp AND event.action:compute.instances.setMetadata AND event.outcome:success AND gcp.audit.metadata.request.key:ssh-keys",
      "results": {
        "TP": 0,
        "FN": 1,
        "FP": 0,
        "TN": 3
      },
      "metrics": {
        "TP": 0,
        "FN": 1,
        "FP": 0,
        "TN": 3,
        "total": 4,
        "precision": 0.0,
        "recall": 0.0,
        "f1_score": 0.0,
        "accuracy": 0.75
      },
      "details": [
        {
          "test_num": 1,
          "test_type": "TP",
          "description": "Successful addition of SSH key to instance metadata",
          "expected_match": true,
          "actual_match": false,
          "outcome": "FN"
        },
        {
          "test_num": 2,
          "test_type": "FN",
          "description": "SSH key added via OS Login API (different API)",
          "expected_match": false,
          "actual_match": false,
          "outcome": "TN"
        },
        {
          "test_num": 3,
          "test_type": "FP",
          "description": "Legitimate setting of other instance metadata",
          "expected_match": false,
          "actual_match": false,
          "outcome": "TN"
        },
        {
          "test_num": 4,
          "test_type": "TN",
          "description": "Normal GCP compute instance listing",
          "expected_match": false,
          "actual_match": false,
          "outcome": "TN"
        }
      ]
    },
    {
      "rule_name": "akira_ransomware_-_service_stop_(process_execution)",
      "query": "event.category:process AND event.type:start AND event.code:(1 OR 4688) AND (process.name:(*net* OR *sc* OR *taskkill*) AND process.command_line:(*stop* OR *config*start*=disabled* OR *F*IM*))",
      "results": {
        "TP": 3,
        "FN": 0,
        "FP": 3,
        "TN": 0
      },
      "metrics": {
        "TP": 3,
        "FN": 0,
        "FP": 3,
        "TN": 0,
        "total": 6,
        "precision": 0.5,
        "recall": 1.0,
        "f1_score": 0.667,
        "accuracy": 0.5
      },
      "details": [
        {
          "test_num": 1,
          "test_type": "TP",
          "description": "Malicious net stop command",
          "expected_match": true,
          "actual_match": true,
          "outcome": "TP"
        },
        {
          "test_num": 2,
          "test_type": "TP",
          "description": "Malicious sc config to disable service",
          "expected_match": true,
          "actual_match": true,
          "outcome": "TP"
        },
        {
          "test_num": 3,
          "test_type": "TP",
          "description": "Malicious taskkill to terminate process",
          "expected_match": true,
          "actual_match": true,
          "outcome": "TP"
        },
        {
          "test_num": 4,
          "test_type": "FN",
          "description": "Service stopped via PowerShell Stop-Service cmdlet",
          "expected_match": false,
          "actual_match": true,
          "outcome": "FP"
        },
        {
          "test_num": 5,
          "test_type": "FP",
          "description": "Admin starting a service",
          "expected_match": false,
          "actual_match": true,
          "outcome": "FP"
        },
        {
          "test_num": 6,
          "test_type": "TN",
          "description": "Normal system activity (cmd.exe)",
          "expected_match": false,
          "actual_match": true,
          "outcome": "FP"
        }
      ]
    },
    {
      "rule_name": "scattered_spider_-_gcp_modify_compute_startup_script",
      "query": "event.category:api AND cloud.provider:gcp AND event.action:compute.instances.setMetadata AND event.outcome:success AND gcp.audit.metadata.request.key:startup-script",
      "results": {
        "TP": 0,
        "FN": 1,
        "FP": 0,
        "TN": 3
      },
      "metrics": {
        "TP": 0,
        "FN": 1,
        "FP": 0,
        "TN": 3,
        "total": 4,
        "precision": 0.0,
        "recall": 0.0,
        "f1_score": 0.0,
        "accuracy": 0.75
      },
      "details": [
        {
          "test_num": 1,
          "test_type": "TP",
          "description": "Successful modification of instance startup script",
          "expected_match": true,
          "actual_match": false,
          "outcome": "FN"
        },
        {
          "test_num": 2,
          "test_type": "FN",
          "description": "Startup script modified via gcloud CLI using metadata-from-file (content not directly in key)",
          "expected_match": false,
          "actual_match": false,
          "outcome": "TN"
        },
        {
          "test_num": 3,
          "test_type": "FP",
          "description": "Legitimate setting of other instance metadata",
          "expected_match": false,
          "actual_match": false,
          "outcome": "TN"
        },
        {
          "test_num": 4,
          "test_type": "TN",
          "description": "Normal GCP project metadata update",
          "expected_match": false,
          "actual_match": false,
          "outcome": "TN"
        }
      ]
    },
    {
      "rule_name": "akira_ransomware_-_inhibit_system_recovery_(shadow_copy_deletion)",
      "query": "event.category:process AND event.type:start AND event.code:(1 OR 4688) AND (process.name:(*vssadmin* OR *wmic* OR *bcdedit*) AND process.command_line:(*delete*shadows* OR *shadowcopy*delete* OR *recoveryenabled*no* OR *bootstatuspolicy*ignoreallfailures*))",
      "results": {
        "TP": 3,
        "FN": 0,
        "FP": 3,
        "TN": 0
      },
      "metrics": {
        "TP": 3,
        "FN": 0,
        "FP": 3,
        "TN": 0,
        "total": 6,
        "precision": 0.5,
        "recall": 1.0,
        "f1_score": 0.667,
        "accuracy": 0.5
      },
      "details": [
        {
          "test_num": 1,
          "test_type": "TP",
          "description": "Malicious vssadmin shadow deletion",
          "expected_match": true,
          "actual_match": true,
          "outcome": "TP"
        },
        {
          "test_num": 2,
          "test_type": "TP",
          "description": "Malicious wmic shadow copy deletion",
          "expected_match": true,
          "actual_match": true,
          "outcome": "TP"
        },
        {
          "test_num": 3,
          "test_type": "TP",
          "description": "Malicious bcdedit to disable recovery",
          "expected_match": true,
          "actual_match": true,
          "outcome": "TP"
        },
        {
          "test_num": 4,
          "test_type": "FN",
          "description": "PowerShell evasion using WMI API to delete shadow copies",
          "expected_match": false,
          "actual_match": true,
          "outcome": "FP"
        },
        {
          "test_num": 5,
          "test_type": "FP",
          "description": "Admin checking shadow copy status",
          "expected_match": false,
          "actual_match": true,
          "outcome": "FP"
        },
        {
          "test_num": 6,
          "test_type": "TN",
          "description": "Normal system activity (explorer.exe)",
          "expected_match": false,
          "actual_match": true,
          "outcome": "FP"
        }
      ]
    },
    {
      "rule_name": "akira_ransomware_-_service_stop_(service_control_manager_events)",
      "query": "event.category:service AND event.type:(stop OR change) AND event.code:(7036 OR 7040)",
      "results": {
        "TP": 2,
        "FN": 0,
        "FP": 3,
        "TN": 0
      },
      "metrics": {
        "TP": 2,
        "FN": 0,
        "FP": 3,
        "TN": 0,
        "total": 5,
        "precision": 0.4,
        "recall": 1.0,
        "f1_score": 0.571,
        "accuracy": 0.4
      },
      "details": [
        {
          "test_num": 1,
          "test_type": "TP",
          "description": "Service entered stopped state (Event ID 7036)",
          "expected_match": true,
          "actual_match": true,
          "outcome": "TP"
        },
        {
          "test_num": 2,
          "test_type": "TP",
          "description": "Service start type changed (Event ID 7040)",
          "expected_match": true,
          "actual_match": true,
          "outcome": "TP"
        },
        {
          "test_num": 3,
          "test_type": "FN",
          "description": "Service stopped via taskkill (process event)",
          "expected_match": false,
          "actual_match": true,
          "outcome": "FP"
        },
        {
          "test_num": 4,
          "test_type": "FP",
          "description": "Legitimate service restart (multiple 7036/7035 events)",
          "expected_match": false,
          "actual_match": true,
          "outcome": "FP"
        },
        {
          "test_num": 5,
          "test_type": "TN",
          "description": "Normal system event (non-service related)",
          "expected_match": false,
          "actual_match": true,
          "outcome": "FP"
        }
      ]
    },
    {
      "rule_name": "scattered_spider_-_gcp_launch_new_cloud_resources_(compute_instance)",
      "query": "event.category:api AND cloud.provider:gcp AND event.action:compute.instances.insert AND event.outcome:success",
      "results": {
        "TP": 2,
        "FN": 0,
        "FP": 3,
        "TN": 0
      },
      "metrics": {
        "TP": 2,
        "FN": 0,
        "FP": 3,
        "TN": 0,
        "total": 5,
        "precision": 0.4,
        "recall": 1.0,
        "f1_score": 0.571,
        "accuracy": 0.4
      },
      "details": [
        {
          "test_num": 1,
          "test_type": "TP",
          "description": "Successful creation of a single GCP compute instance",
          "expected_match": true,
          "actual_match": true,
          "outcome": "TP"
        },
        {
          "test_num": 2,
          "test_type": "TP",
          "description": "Successful bulk creation of GCP compute instances",
          "expected_match": true,
          "actual_match": true,
          "outcome": "TP"
        },
        {
          "test_num": 3,
          "test_type": "FN",
          "description": "Creation of other cloud resources (e.g., storage bucket)",
          "expected_match": false,
          "actual_match": true,
          "outcome": "FP"
        },
        {
          "test_num": 4,
          "test_type": "FP",
          "description": "Legitimate creation of a new compute instance by a developer",
          "expected_match": false,
          "actual_match": true,
          "outcome": "FP"
        },
        {
          "test_num": 5,
          "test_type": "TN",
          "description": "Normal GCP compute instance deletion",
          "expected_match": false,
          "actual_match": true,
          "outcome": "FP"
        }
      ]
    },
    {
      "rule_name": "scattered_spider_-_gcp_modify_firewall_rules",
      "query": "event.category:api AND cloud.provider:gcp AND event.action:(compute.firewalls.insert OR compute.firewalls.update) AND event.outcome:success",
      "results": {
        "TP": 2,
        "FN": 0,
        "FP": 3,
        "TN": 0
      },
      "metrics": {
        "TP": 2,
        "FN": 0,
        "FP": 3,
        "TN": 0,
        "total": 5,
        "precision": 0.4,
        "recall": 1.0,
        "f1_score": 0.571,
        "accuracy": 0.4
      },
      "details": [
        {
          "test_num": 1,
          "test_type": "TP",
          "description": "Successful creation of a new GCP firewall rule",
          "expected_match": true,
          "actual_match": true,
          "outcome": "TP"
        },
        {
          "test_num": 2,
          "test_type": "TP",
          "description": "Successful update of an existing GCP firewall rule",
          "expected_match": true,
          "actual_match": true,
          "outcome": "TP"
        },
        {
          "test_num": 3,
          "test_type": "FN",
          "description": "Firewall rule modification via gcloud CLI (assuming different API call)",
          "expected_match": false,
          "actual_match": true,
          "outcome": "FP"
        },
        {
          "test_num": 4,
          "test_type": "FP",
          "description": "Legitimate listing of GCP firewall rules",
          "expected_match": false,
          "actual_match": true,
          "outcome": "FP"
        },
        {
          "test_num": 5,
          "test_type": "TN",
          "description": "Normal GCP compute instance deletion",
          "expected_match": false,
          "actual_match": true,
          "outcome": "FP"
        }
      ]
    },
    {
      "rule_name": "akira_ransomware_-_data_encrypted_for_impact_(ransom_note_creation)",
      "query": "event.category:file AND event.type:creation AND event.code:11 AND file.name:(*readme* OR *how_to_decrypt* OR *restore_files*) AND file.extension:(txt OR html OR hta)",
      "results": {
        "TP": 2,
        "FN": 0,
        "FP": 3,
        "TN": 0
      },
      "metrics": {
        "TP": 2,
        "FN": 0,
        "FP": 3,
        "TN": 0,
        "total": 5,
        "precision": 0.4,
        "recall": 1.0,
        "f1_score": 0.571,
        "accuracy": 0.4
      },
      "details": [
        {
          "test_num": 1,
          "test_type": "TP",
          "description": "Creation of typical Akira ransom note",
          "expected_match": true,
          "actual_match": true,
          "outcome": "TP"
        },
        {
          "test_num": 2,
          "test_type": "TP",
          "description": "Creation of generic HTML ransom note",
          "expected_match": true,
          "actual_match": true,
          "outcome": "TP"
        },
        {
          "test_num": 3,
          "test_type": "FN",
          "description": "Ransom note content appended to existing file",
          "expected_match": false,
          "actual_match": true,
          "outcome": "FP"
        },
        {
          "test_num": 4,
          "test_type": "FP",
          "description": "Legitimate software creating a readme.txt",
          "expected_match": false,
          "actual_match": true,
          "outcome": "FP"
        },
        {
          "test_num": 5,
          "test_type": "TN",
          "description": "Normal file creation (log file)",
          "expected_match": false,
          "actual_match": true,
          "outcome": "FP"
        }
      ]
    }
  ]
}